<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>å“è˜­å¦™ç„å®® - ğŸ  é¦–é </title>
  <link rel="stylesheet" href="styles.css">
  <style>
    form {
      max-width: 600px;
      margin: 40px auto;
      background: #f8f8f8;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }
    form label {
      display: block;
      margin: 12px 0 6px;
      font-weight: bold;
    }
    form input[type="text"],
    form input[type="number"] {
      width: 100%;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    form button {
      margin-top: 20px;
      padding: 12px 24px;
      border: none;
      background: #c7a15b;
      color: #fff;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
    }
    form button:hover {
      background: #b8903a;
    }
  </style>
</head>
<body class="index-page">

  <!-- è·‘é¦¬ç‡ˆå…¬å‘Š -->
  <div class="marquee-notice">
    <p>ğŸ”” è¾¦äº‹æ™‚é–“ç‚º 15:00ï½18:00ã€19:00ï½21:30ã€‚æ¯é€¢è¾²æ›†åˆä¸€ã€åäº”ã€æ˜ŸæœŸä¸€éœä¿®æ—¥ã€è¾²æ›†ä¸ƒæœˆåŠé‡è¦å®®æ…¶ç¥­å…¸çš† âŒ ä¸è¾¦äº‹ã€‚å»ºè­°å…ˆé›»è©±è©¢å•å¸«å§æ˜¯å¦åœ¨å®®ä¸­ä»¥å…ç™½è·‘ä¸€è¶Ÿã€‚</p>
  </div>

  <!-- ä¸»è¦–è¦ºå€ -->
  <div class="hero">
    <img src="images/main-bg.png" class="main-bg" alt="å¦™ç„å®®ä¸»èƒŒæ™¯">
  </div>

  <!-- å·¦å´é›²æœµå°è¦½ -->
  <div class="left-floating-menu">
    <a href="index.html">ğŸ  é¦–é </a>
    <a href="about.html">ğŸ™ æœ¬å®®ä»‹ç´¹</a>
    <a href="service.html">ğŸ•¯ï¸ æœå‹™é …ç›®</a>
    <a href="news.html">ğŸ“¢ æœ€æ–°æ¶ˆæ¯</a>
    <a href="calendar.html">ğŸ“… è¡Œäº‹æ›†</a>
    <a href="signup.html">ğŸ“ æ´»å‹•å ±å</a>
    <a href="contact.html">â˜ï¸ è¯çµ¡æˆ‘å€‘</a>
  </div>

  <!-- å ±åè¡¨å–® -->
  <form id="puduForm" action="javascript:void(0);" onsubmit="return false;">
    <h2>ä¸­å…ƒæ™®æ¸¡å ±åè¡¨</h2>

    <label for="name">å§“å</label>
    <input type="text" name="å§“å" required>

    <label for="phone">é›»è©±</label>
    <input type="text" name="é›»è©±" required>

    <label>ã€ä¸€ã€‘å€‹äººè´Šæ™®æ¡Œï¼ˆæ¯æ¡Œ3600å…ƒï¼‰</label>
    <input type="number" name="ã€ä¸€ã€‘å€‹äººè´Šæ™®æ¡Œï¼ˆæ¯æ¡Œå«é‡‘ç´™ 3600 å…ƒï¼‰" min="0" max="9">

    <label>ã€äºŒã€‘è²¡æ°´æ¡Œï¼ˆæ¯æ¡Œ3600å…ƒï¼‰</label>
    <input type="number" name="ã€äºŒã€‘è²¡æ°´æ¡Œï¼ˆæ¯æ¡Œ 3600 å…ƒï¼‰" min="0" max="1">

    <label>ã€ä¸‰ã€‘è—¥è‰æ¡Œï¼ˆæ¯æ¡Œ3600å…ƒï¼‰</label>
    <input type="number" name="ã€ä¸‰ã€‘è—¥è‰æ¡Œï¼ˆ3600 å…ƒï¼‰" min="0" max="1">

    <label>ã€å››ã€‘äº”è‰²è±†æ¡Œï¼ˆæ™‚åƒ¹ï¼‰</label>
    <input type="number" name="ã€å››ã€‘äº”è‰²è±†æ¡Œï¼ˆæ™‚åƒ¹ï¼‰" min="0" max="1">

    <label>ã€äº”ã€‘äº”è”¬æœæ¡Œï¼ˆæ™‚åƒ¹ï¼‰</label>
    <input type="number" name="ã€äº”ã€‘äº”è”¬æœæ¡Œï¼ˆæ™‚åƒ¹ï¼‰" min="0" max="1">

    <label>ã€å…­ã€‘è‚‰ç²½æ¡Œï¼ˆæ™‚åƒ¹ï¼‰</label>
    <input type="number" name="ã€å…­ã€‘è‚‰ç²½æ¡Œï¼ˆæ™‚åƒ¹ï¼‰" min="0" max="1">

    <label>ã€ä¸ƒã€‘ç™¾ç±³æ¡Œï¼ˆ1700å…ƒï¼‰</label>
    <input type="number" name="ã€ä¸ƒã€‘ç™¾ç±³æ¡Œï¼ˆ50 å°æ–¤/ä»½ï¼Œ1700 å…ƒï¼‰" min="0" max="36">

    <label>ã€å…«ã€‘å€‹äººä¾›å“ï¼ˆ1700å…ƒï¼‰</label>
    <input type="number" name="ã€å…«ã€‘å€‹äººä¾›å“ï¼ˆ1700 å…ƒ/ä»½ï¼‰" min="0">

    <label>ã€ä¹ã€‘å…±åŒæ™®æ¸¡æ¡Œï¼ˆ3200å…ƒ/äººï¼‰</label>
    <input type="number" name="ã€ä¹ã€‘å…±åŒæ™®æ¸¡æ¡Œï¼ˆ3200 å…ƒ/äººï¼‰" min="0">

    <label>å†¤è¦ªå‚µä¸»ï¼ˆä»½æ•¸ï¼‰</label>
    <input type="number" name="å†¤è¦ªå‚µä¸»" min="0">

    <label>å¬°éˆï¼ˆä»½æ•¸ï¼‰</label>
    <input type="number" name="å¬°éˆ" min="0">

    <label>åœ°åŸºä¸»ï¼ˆä»½æ•¸ï¼‰</label>
    <input type="number" name="åœ°åŸºä¸»" min="0">

    <label>å„å§“ç¥–å…ˆï¼ˆä»½æ•¸ï¼‰</label>
    <input type="number" name="å„å§“ç¥–å…ˆ" min="0">

    <label>ç¥–å…ˆå§“æ°</label>
    <input type="text" name="ç¥–å…ˆå§“æ°">

    <label>å°ˆè¶…äº¡é­‚ï¼ˆä»½æ•¸ï¼‰</label>
    <input type="number" name="å°ˆè¶…äº¡é­‚" min="0">

    <label>å°ˆè¶…äº¡é­‚å§“å</label>
    <input type="text" name="å°ˆè¶…äº¡é­‚å§“å">

    <button type="submit">é€å‡ºå ±å</button>
  </form>

 <script>
  (function () {
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxywEzIABRBNQCQrkbYuzi16wWEfdpnmy_RKzV8TLNoL8KNBZksjVDzy1ZZ8nO7hKaPfQ/exec";

    // å·¥å…·ï¼šæŠŠè¡¨å–®è³‡æ–™è½‰æˆç‰©ä»¶
    function collectFormData(form) {
      const fd = new FormData(form);
      const obj = {};
      fd.forEach((v, k) => { obj[k] = v; });
      return obj;
    }

    // ä¿åº•é€æ³•ï¼šç”¨éš±è— iframe + åŸç”Ÿ POSTï¼ˆä¸ç¶“ fetchã€ä¸æœƒè¢« AJAX/CORS é™åˆ¶ï¼‰
    function fallbackSubmit(payloadJSON, onDone) {
      // å»ºç«‹éš±è— iframe
      let iframe = document.getElementById("pudu_hidden_iframe");
      if (!iframe) {
        iframe = document.createElement("iframe");
        iframe.style.display = "none";
        iframe.name = "pudu_hidden_iframe";
        iframe.id = "pudu_hidden_iframe";
        document.body.appendChild(iframe);
      }
      // å»ºç«‹ä¸€æ¬¡æ€§ form
      const form = document.createElement("form");
      form.method = "POST";
      form.action = SCRIPT_URL;
      form.target = "pudu_hidden_iframe";
      form.style.display = "none";

      const input = document.createElement("input");
      input.type = "hidden";
      input.name = "payload";         // å¾Œç«¯ read e.parameter.payload
      input.value = payloadJSON;
      form.appendChild(input);

      document.body.appendChild(form);

      // å˜—è©¦åœ¨ iframe è¼‰å…¥å®Œæˆæ™‚ callbackï¼ˆéƒ¨åˆ†è£ç½®ä¸æœƒè§¸ç™¼ï¼Œä¹Ÿç„¡å¦¨ï¼‰
      const doneOnce = (() => {
        let called = false;
        return () => { if (!called) { called = true; onDone && onDone(); } };
      })();
      iframe.onload = doneOnce;

      // æäº¤
      try { form.submit(); } catch (_) {}
      // æœ€ä¿éšªï¼š2 ç§’å¾Œä¹Ÿè¦–ç‚ºæˆåŠŸï¼ˆApps Script å¯«å…¥é€šå¸¸ < 1sï¼‰
      setTimeout(doneOnce, 2000);

      // æ¸…ç†
      setTimeout(() => { try { document.body.removeChild(form); } catch (_) {} }, 3000);
    }

    // ç¶å®š submitï¼ˆå«ä¸‰é‡é˜²å‘†ï¼‰
    document.addEventListener('DOMContentLoaded', function () {
      const form = document.getElementById('puduForm');
      if (!form) { alert("æ‰¾ä¸åˆ°è¡¨å–® #puduForm"); return; }

      form.setAttribute("action", "javascript:void(0);");
      form.setAttribute("onsubmit", "return false;");
      form.onsubmit = function (ev) { ev.preventDefault(); return false; };

      form.addEventListener('submit', async function (e) {
        e.preventDefault();

        // æ”¶é›†è³‡æ–™
        const dataObj = collectFormData(form);
        const payloadJSON = JSON.stringify(dataObj);

        // å…ˆå˜—è©¦ fetchï¼ˆé¿å…é æª¢ï¼‰
        const urlParams = new URLSearchParams();
        urlParams.set("payload", payloadJSON);

        let usedFallback = false;
        try {
          const res = await fetch(SCRIPT_URL, { method: "POST", body: urlParams });
          const txt = await res.text();
          if (!res.ok) throw new Error(`HTTP ${res.status}ï¼š${txt || "ï¼ˆç„¡å…§å®¹ï¼‰"}`);
          if (!txt || !txt.toLowerCase().includes("success")) throw new Error(`ä¼ºæœå™¨å›æ‡‰ï¼š${txt || "ï¼ˆç©ºç™½ï¼‰"}`);
          // fetch æˆåŠŸ
          window.location.href = "success.html";
        } catch (err) {
          // fetch è¢«æ“‹ï¼ˆå¸¸è¦‹ï¼šiOS Safari/éƒ¨åˆ†ç€è¦½å™¨é¡¯ç¤º load failedï¼‰ï¼Œèµ°ä¿åº•é€æ³•
          usedFallback = true;
          fallbackSubmit(payloadJSON, function () {
            // ä¸å†ä¾è³´è®€å›æ‡‰ï¼Œç›´æ¥å°å‘æˆåŠŸé ï¼ˆå¾Œç«¯å·²æ¥åˆ°å°±æœƒå¯«å…¥ï¼‰
            window.location.href = "success.html";
          });
        }
      });
    });
  })();
</script>
</body>
</html>
